<%if params[:category2] %>

  <div class="flex-container">
    <%cnt=0%>
    <% @items.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
        
      </div>
    <% end %>
  </div>
<%elsif params[:category1]%>
    <div class="flex-container">
    <%cnt=0%>
    <% @items.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
        
      </div>
    <% end %>
  </div>
<%elsif params[:item_name]%>
    <div class="flex-container">
    <%cnt=0%>
    <% @items.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
        
      </div>
    <% end %>
  </div>
  <h2>Recomended items</h2>
     <div class="flex-container">
    <%cnt=0%>
    <% @items1.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
      </div>
    <% end %>
  </div>
   <div class="flex-container">
    <%cnt=0%>
    <% @items2.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
      </div>
    <% end %>
  </div>

<% elsif params[:shop_name]%>
  <div class="flex-container">
    <% @shops.each do |shop| %>
      <div class="card" style="margin-right: 40px; margin-left: 75px; margin-bottom: 40px;">
        <% if shop.shop_image.present? %>
          <%= link_to shop_items_path(shop), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(shop.shop_image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        <h1><%= shop.shop_name %><p style="font-size: medium;"><%= @shopRating_map[shop.id]%>‚≠ê</p></h1>
        <p class="price"><%= shop.shop_summary %></p>
        
      </div>
    <% end %>
  </div>
  <h2>Recomended items from the shops are</h2>
  <div class="flex-container">
    <%cnt=0%>
    <% @items.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
      </div>
    <% end %>
  </div>

<%else%>
  
  <div id="location-form" style="width:500px;height:300px;background-color:white;padding:20px;border:solid black;border-radius: 20px;position:fixed; top:200px;left:400px;z-index:5000;">
    <!-- Your location form content here -->
    <button id="hide-location-form" style="border:none;background-color:white;position:relative; left:442px; bottom: 18px">X</button>
    <%= form_with url: currentlocation_path, method: :post do |form| %>
      <div class="form-group">
        <%= form.label :city, "Select City" %>
        <%= form.select :city, ["--",'Delhi', 'Haridwar', 'Bangalore', 'Pune', 'Mumbai'], {include_blank: 'Select a city'}, class: 'form-control', id: 'city-select' %>
      </div>
      <div class="form-group" id="area-group" style="display: none;">
        <%= form.label :area, "Select Area" %>
        <%= form.select :area, [], class: 'form-control', id: 'area-select' %>
      </div>
      <%= form.submit "Change location", class: 'btn btn-primary', style: "position:relative;top:20px" %>
    <% end %>


    
    
  </div>
  
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <div class="navbar-brand" style="position:relative;bottom:5px"><%= link_to "HOME", root_path, style: "color: green; font-size: 20px; padding-left: 15px; text-decoration: none;text-decoration: underline;" %></div>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <div class="nav-link active" aria-current="page">
            <%= link_to "OFFERS", offers_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %>
            </div>
          </li>
          <li class="nav-item">
            <div class="nav-link active" aria-current="page">
            <%= link_to "NEW", newshops_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %>
            </div>
          </li>
          <li class="nav-item">
            <div class="nav-link active" aria-current="page">
            <%= link_to "TRENDING", trending_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %>
            </div>
          </li>
          <li class="nav-item">
            <div class="nav-link active" aria-current="page">
            <%= link_to "CARTüõí", carts_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %>
            </div>
          </li>
          <% if @user==nil %>
            <li class="nav-item">
              <div class="nav-link active" aria-current="page">
              <%= link_to "Login", login_path, class: "btn btn-primary" %>
              </div>
              </li>
          <% end %>
          <% if @user %>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="font-size: 20px;color: black;margin-left:15px">
              EDIT PROFILE
            </a>
            
              <ul class="dropdown-menu">
              
                <li><a class="dropdown-item" href="#">
                  <% if @user %>
                      Logged in as: <%= @user.email %>
                  <% else %>
                      <%= link_to "Login", login_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %>
                      <hr>
                      <%= link_to "Signup", signup_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %>
                      <hr>
                  <% end %> 
                </a></li>
                <% if @user %>
                  <li class="dropdown-item">
                  <%= button_to "Logout", logout_path, method: :delete, class: "btn btn-primary" %>
                  <hr>
                  </li>
                <% end %>
                <li><%= link_to "VIEW PROFILE", profile_path, style: "color: black; font-size: 20px; padding-left: 15px; text-decoration: none;" %></li>
              </ul>
              
          </li>
          <% end %>
        </ul>
        <%# <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form> %>
        <!-- app/views/shops/new.html.erb -->
        <div>
          <%= link_to image_tag("location_logo.png", alt: "Image Description",style:"height: 30px;position:relative;right:600px;z-index:5000;", id:"show-location-form")%>
        </div>
        <div style="display:flex;flex-direction:column;position: absolute; top: 0; left: 990px; z-index: 1000;margin-top:10px">
          <%= form_tag('search', method: 'post') do %>
            <div class="d-flex flex-row justify-content-center align-items-center">
              <div class="mr-5" style="width:180px;margin-left:0px">
                <%= text_field_tag 'shop_name', nil, class: 'form-control', placeholder: 'Search shop and items',oninput: "this.form.requestSubmit()" %>
              </div>
              <div>
                <%= submit_tag 'Search', class: 'btn btn-primary' %>
              </div>
            </div>
          <% end %>
          <div id="search_results" style="background-color:white"></div>
        </div>


      </div>
    </div>
  </nav>

  
 
  
  <div id="carouselExample" class="carousel slide">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="<%= asset_path("slider1.jpg") %>" class="d-block w-100" alt="..." height="400px">
      </div>
      <div class="carousel-item">
        <img src="<%= asset_path("slider2.jpg") %>" class="d-block w-100" alt="..." height="400px">
      </div>
      <div class="carousel-item">
        <img src="<%= asset_path("slider3.png") %>" class="d-block w-100" alt="..." height="400px">
      </div>
      <div class="carousel-item">
        <img src="<%= asset_path("slider4.jpg") %>" class="d-block w-100" alt="..." height="400px">
      </div>
      <div class="carousel-item">
        <img src="<%= asset_path("slider5.jpg") %>" class="d-block w-100" alt="..." height="400px">
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div>
    <img src="<%= asset_path("offers-image.png") %>" class="d-block w-100" alt="..." height="200px">
  </div>

  <div style="display:flex; flex-direction: row">
    <img src="<%= asset_path("free-1.png") %>" class="d-block w-30" alt="..." height="200px" margin-right="140px">
    <img src="<%= asset_path("free-2.png") %>" class="d-block w-30" alt="..." height="200px">
    <img src="<%= asset_path("free-3.png") %>" class="d-block w-30" alt="..." height="200px">
  </div>
  <div><h1 style="color:blue">Trending items üìà</h1></div>
  <div class="flex-container">
    <%cnt=0%>
    <% @items.each do |item| %>
      <div class="card" style="margin-left: 10px; margin-bottom: 40px;">
        <% if item.image.present? %>
          <%= link_to shop_items_path(shop_id: item.shop_id), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(item.image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= item.item_name %><p style="font-size: medium;"><%= @rating_map[item.id]%>‚≠ê</p></h1>
        <%shop=Shop.find_by(id: item.shop_id)%>
        <p class="price"><%= shop.shop_name %></p>
      </div>
    <% end %>
  </div>

  <h2 style="text-align:center">Listed Shops</h2>

  <div class="flex-container">
    <% @shops.each do |shop| %>
      <div class="card" style="margin-right: 40px; margin-left: 75px; margin-bottom: 40px;">
        <% if shop.shop_image.present? %>
          <%= link_to shop_items_path(shop), style: "text-decoration: none; color: inherit;" do %>
            <%= image_tag(shop.shop_image, style: "width: 300px; height: 250px") %>
          <% end %>
        <% end %>
        
        <h1><%= shop.shop_name %><p style="font-size: medium;"><%= @shopRating_map[shop.id]%>‚≠ê</p></h1>
        <p class="price"><%= shop.shop_summary %></p>
        
      </div>
    <% end %>
  </div>
<%end%>


